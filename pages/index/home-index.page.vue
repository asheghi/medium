<template>
  <div class="HomePage min-h-screen flex justify-center items-center">
    <div class="header">
      Awesome SSR Blog
    </div>
    <div class="content">
      <a
        v-for="post in posts"
        :key="post.id"
        :href="'/post/' + post.id"
        class="post"
      >
        <h2
          class="title"
          v-text="post.title"
        />
        <img
          v-if="getImageSrc(post.image)"
          :src="getImageSrc(post.image)"
          alt=""
          class="image"
        >
        <div
          class="short-desc"
          v-html="post.shortDesc"
        />
      </a>
      <div class="pagination">
        <a
          v-if="page > 1"
          :href="'/?page='+(page - 1)"
          class="link newer"
        >
          <div class="icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 32 32"
            ><path d="M 23.398438 14.023438 C 23.058594 14.042969 22.835938 13.933594 22.808594 13.914063 L 21.121094 14.992188 C 21.492188 15.574219 22.257813 15.96875 23.117188 16.019531 C 23.183594 16.023438 23.25 16.023438 23.316406 16.023438 C 24.445313 16.023438 25.554688 15.453125 26.394531 14.4375 C 27.828125 12.695313 28.835938 10.847656 28.878906 10.769531 L 29.332031 9.929688 L 28.515625 9.4375 C 23.984375 6.714844 21.394531 8.007813 20.492188 8.691406 C 19.328125 9.574219 18.796875 11.019531 19.089844 12.429688 C 18.160156 13.023438 17.234375 13.773438 16.496094 14.6875 C 16.070313 13.691406 15.40625 12.796875 14.632813 12.007813 C 14.703125 11.824219 14.75 11.644531 14.78125 11.511719 C 14.796875 11.441406 14.8125 11.375 14.832031 11.316406 C 15.34375 9.601563 14.640625 7.601563 13.082031 6.34375 C 11.972656 5.449219 8.820313 3.683594 3.519531 6.605469 L 2.835938 6.980469 L 3.03125 7.730469 C 3.070313 7.882813 4.015625 11.445313 5.894531 13.53125 C 6.707031 14.433594 7.726563 14.941406 8.847656 14.996094 C 8.917969 15 8.988281 15 9.054688 15 C 10.3125 15 11.390625 14.441406 11.828125 14.042969 L 10.484375 12.5625 C 10.46875 12.574219 8.789063 13.753906 7.382813 12.191406 C 6.292969 10.984375 5.550781 9.046875 5.199219 7.984375 C 8.984375 6.160156 11.078125 7.296875 11.824219 7.898438 C 12.699219 8.605469 13.132813 9.648438 12.953125 10.554688 C 10.800781 8.960938 8.558594 8.070313 8.378906 8.003906 L 7.65625 9.867188 C 9.699219 10.65625 15 13.484375 15 17 L 15 20.144531 C 14.238281 20.34375 13.542969 20.753906 13.019531 21.34375 C 12.550781 21.117188 12.035156 21 11.5 21 C 10.070313 21 8.839844 21.859375 8.296875 23.09375 C 8.035156 23.03125 7.769531 23 7.5 23 C 5.570313 23 4 24.570313 4 26.5 L 4 27 L 6 27 L 6 26.5 C 6 25.671875 6.671875 25 7.5 25 C 7.902344 25 8.210938 25.167969 8.398438 25.308594 L 10 24.511719 L 10 24.496094 C 10.003906 23.671875 10.675781 23 11.5 23 C 11.902344 23 12.28125 23.160156 12.566406 23.449219 L 14.1875 23.167969 C 14.515625 22.457031 15.226563 22 16 22 C 16.726563 22 17.398438 22.40625 17.75 23.0625 L 19.328125 23.304688 C 19.527344 23.109375 19.792969 23 20.070313 23 C 20.65625 23 21.136719 23.480469 21.136719 24.066406 C 21.136719 24.183594 21.113281 24.300781 21.066406 24.429688 L 22.671875 25.519531 C 22.9375 25.28125 23.382813 25 24 25 C 25.101563 25 26 25.898438 26 27 L 28 27 C 28 24.792969 26.207031 23 24 23 C 23.65625 23 23.316406 23.046875 22.992188 23.132813 C 22.59375 21.894531 21.433594 21 20.070313 21 C 19.652344 21 19.253906 21.082031 18.878906 21.238281 C 18.367188 20.703125 17.714844 20.332031 17 20.144531 L 17 19 L 17.003906 19 L 17.003906 18.671875 C 17.003906 14.519531 23.535156 12.53125 23.601563 12.511719 L 23.039063 10.59375 C 22.9375 10.621094 22.121094 10.871094 21.046875 11.363281 C 21.125 10.949219 21.339844 10.5625 21.703125 10.289063 C 22.761719 9.484375 24.558594 9.636719 26.617188 10.675781 C 26.214844 11.332031 25.589844 12.273438 24.851563 13.167969 C 24.300781 13.835938 23.757813 14.003906 23.398438 14.023438 Z M 13.484375 10.820313 L 13.496094 10.976563 C 13.445313 10.9375 13.390625 10.898438 13.339844 10.855469 C 13.386719 10.84375 13.429688 10.824219 13.484375 10.820313 Z" /></svg>
          </div>
          <div class="text">
            newer posts
          </div>
        </a>
        <a
          v-if="page < pageCount"
          :href="'/?page='+(page + 1)"
          class="link older"
        >
          <div class="icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 32 32"
            ><path d="M 16 3.59375 L 15.28125 4.28125 L 9.34375 10.25 L 8.34375 11.21875 L 9.625 11.84375 C 9.625 11.84375 10.640625 12.210938 12.0625 12.53125 L 7.65625 16.9375 L 6.65625 17.90625 L 7.90625 18.53125 C 7.90625 18.53125 8.984375 18.835938 9.53125 19.03125 L 5.9375 22.625 L 4.96875 23.625 L 6.21875 24.25 C 6.21875 24.25 8.65625 25.425781 13 25.84375 L 13 29 L 15 29 L 15 25.96875 C 15.335938 25.980469 15.648438 26 16 26 C 16.351563 26 16.664063 25.980469 17 25.96875 L 17 29 L 19 29 L 19 25.84375 C 23.351563 25.425781 25.8125 24.25 25.8125 24.25 L 27.03125 23.625 L 26.0625 22.625 L 22.46875 19.03125 C 23.015625 18.835938 24.09375 18.53125 24.09375 18.53125 L 25.34375 17.90625 L 24.34375 16.9375 L 19.9375 12.53125 C 21.359375 12.210938 22.375 11.84375 22.375 11.84375 L 23.65625 11.21875 L 22.65625 10.25 L 16.71875 4.28125 Z M 16 6.4375 L 20 10.40625 C 19.40625 10.605469 19.285156 10.761719 17.8125 10.90625 L 16 11.09375 L 14.1875 10.90625 C 12.714844 10.761719 12.59375 10.605469 12 10.40625 Z M 16 11.4375 L 17.1875 12.59375 L 21.78125 17.1875 C 21.316406 17.351563 21.328125 17.40625 20.375 17.59375 L 18.53125 17.96875 L 19.875 19.28125 L 23.53125 22.9375 C 22.257813 23.394531 20.078125 24 16 24 C 11.960938 24 9.789063 23.394531 8.5 22.9375 L 12.125 19.28125 L 13.46875 17.96875 L 11.625 17.59375 C 10.671875 17.40625 10.683594 17.351563 10.21875 17.1875 L 14.8125 12.59375 Z" /></svg>
          </div>
          <div class="text">
            older posts
          </div>
        </a>
      </div>
    </div>
    <div
      class="footer"
    >
      powered by <span class="text-red-600">â™¥</span>
    </div>
  </div>
</template>

<script>
import { usePageContext } from '../../renderer/usePageContext';
import { getImageSrc } from '../../lib/utils';

export default {
  setup() {
    const { posts, pagination } = usePageContext();
    const { page, pageCount } = pagination || { page: 1, pageCount: 1 };
    return {
      posts, page, pageCount, getImageSrc,
    };
  },
};
</script>
<style lang="scss">
.HomePage{
  @apply flex flex-col gap-8 py-4 px-8 min-h-screen w-full;
  .content{
    @apply container flex flex-col gap-4 mb-auto w-full;
    max-width: 500px;
    .post{
      @apply border px-4 py-2 rounded-xl cursor-pointer;
      .title{
        @apply text-xl tracking-wider capitalize;
      }
      .short-desc{
        @apply opacity-50;
      }
      .image{
        @apply rounded w-full h-auto my-4;
        object-fit: cover;
        max-height: 160px;
      }
    }
  }
  .pagination{
    @apply container flex flex-col sm:flex-row justify-center items-center gap-4;
    .link{
      @apply flex justify-center items-center gap-2 capitalize px-2 py-4
      border rounded-xl whitespace-nowrap w-full;
      flex: 1;
      max-width: 500px;

      .text{
        @apply text-lg tracking-wider  text-gray-600;
      }
    }
    .newer{
      svg{
        fill: theme('colors.green.400')
      }
    }
    .older{
      svg{
        fill: theme('colors.green.800')
      }
    }
  }
  .post,.link{
    @apply transform transition hover:scale-[1.02] active:scale-95
    hover:shadow-lg hover:border-primary-300;
  }
  .footer{
    @apply opacity-50;
  }
}
</style>
